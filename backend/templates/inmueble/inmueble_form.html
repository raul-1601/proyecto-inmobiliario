{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crear Inmueble</title>
    <style>
        .remove-form {
            cursor: pointer;
            display: inline-block;
            color: red;
            font-weight: bold;
            margin-left: 5px;
        }
    </style>
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
</head>
<body>

<h1>Crear Inmueble</h1>

<form method="post" enctype="multipart/form-data">
    {% csrf_token %}

    <fieldset>
        <legend>Datos del Inmueble</legend>
        {{ form.non_field_errors }}
        <div class="mb-3">
            {{ form.region.label_tag }}
            {{ form.region }}
            {{ form.region.errors }}
        </div>
        <div class="mb-3">
            {{ form.comuna.label_tag }}
            {{ form.comuna }}
            {{ form.comuna.errors }}
        </div>
        {% for field in form %}
            {% if field.name != "region" and field.name != "comuna" %}
                <div class="mb-3">
                    {{ field.label_tag }}
                    {{ field }}
                    {{ field.errors }}
                </div>
            {% endif %}
        {% endfor %}
    </fieldset>

    <fieldset id="imagenes-fieldset" data-max="{{ img_formset.max_num }}">
        <legend>Imágenes</legend>
        {{ img_formset.management_form }}
        <div id="imagenes-forms">
            {% for form in img_formset %}
                <div class="formset-form">
                    {{ form.imagen }}
                    <span class="remove-form" onclick="removeForm(this)">✖</span>
                </div>
            {% endfor %}
        </div>
        <button type="button" id="add-imagen">Agregar Imagen</button>
        <p>Máximo {{ img_formset.max_num }} imágenes</p>
        <div id="imagenes-empty-form" style="display: none;">
            <div class="formset-form">
                <input type="file" name="imagenes-__prefix__-imagen" id="id_imagenes-__prefix__-imagen">
                <span class="remove-form" onclick="removeForm(this)">✖</span>
            </div>
        </div>
    </fieldset>

    <fieldset id="documentos-fieldset" data-max="{{ doc_formset.max_num }}">
        <legend>Documentos</legend>
        {{ doc_formset.management_form }}
        <div id="documentos-forms">
            {% for form in doc_formset %}
                <div class="formset-form">
                    {{ form.archivo }}
                    <span class="remove-form" onclick="removeForm(this)">✖</span>
                </div>
            {% endfor %}
        </div>
        <button type="button" id="add-documento">Agregar Documento</button>
        <p>Máximo {{ doc_formset.max_num }} documentos</p>
        <div id="documentos-empty-form" style="display: none;">
            <div class="formset-form">
                <input type="file" name="documentos-__prefix__-archivo" id="id_documentos-__prefix__-archivo">
                <span class="remove-form" onclick="removeForm(this)">✖</span>
            </div>
        </div>
    </fieldset>

    <button type="submit">Guardar</button>
</form>

<script src="{% static 'portal/js/formset_dynamic.js' %}"></script>

</body>
</html>
